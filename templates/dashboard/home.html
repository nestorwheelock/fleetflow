{% extends 'base.html' %}

{% block title %}Dashboard - FleetFlow{% endblock %}

{% block content %}
<div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900">Dashboard</h1>
    <p class="text-gray-600">Welcome back! Here's what's happening today.</p>
</div>

<!-- Stats Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8">
    <div class="bg-white rounded-lg shadow p-6">
        <div class="text-sm font-medium text-gray-500">Total Vehicles</div>
        <div class="text-3xl font-bold text-gray-900">{{ stats.total_vehicles }}</div>
    </div>
    <div class="bg-white rounded-lg shadow p-6">
        <div class="text-sm font-medium text-gray-500">Available</div>
        <div class="text-3xl font-bold text-green-600">{{ stats.available_vehicles }}</div>
    </div>
    <div class="bg-white rounded-lg shadow p-6">
        <div class="text-sm font-medium text-gray-500">Rented</div>
        <div class="text-3xl font-bold text-blue-600">{{ stats.rented_vehicles }}</div>
    </div>
    <div class="bg-white rounded-lg shadow p-6">
        <div class="text-sm font-medium text-gray-500">Total Customers</div>
        <div class="text-3xl font-bold text-gray-900">{{ stats.total_customers }}</div>
    </div>
    <div class="bg-white rounded-lg shadow p-6">
        <div class="text-sm font-medium text-gray-500">Revenue (This Month)</div>
        <div class="text-3xl font-bold text-green-600">${{ revenue_this_month|floatformat:2 }}</div>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Today's Checkouts -->
    <div class="bg-white rounded-lg shadow">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-lg font-semibold text-gray-900">Today's Checkouts</h2>
        </div>
        <div class="p-6">
            {% if today_checkouts %}
            <ul class="divide-y divide-gray-200">
                {% for res in today_checkouts %}
                <li class="py-3 flex justify-between items-center">
                    <div>
                        <p class="font-medium">{{ res.customer }}</p>
                        <p class="text-sm text-gray-500">{{ res.vehicle }}</p>
                    </div>
                    <a href="/dashboard/reservations/{{ res.pk }}/checkout/"
                       class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                        Checkout
                    </a>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p class="text-gray-500">No checkouts scheduled for today.</p>
            {% endif %}
        </div>
    </div>

    <!-- Today's Returns -->
    <div class="bg-white rounded-lg shadow">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-lg font-semibold text-gray-900">Today's Returns</h2>
        </div>
        <div class="p-6">
            {% if today_checkins %}
            <ul class="divide-y divide-gray-200">
                {% for res in today_checkins %}
                <li class="py-3 flex justify-between items-center">
                    <div>
                        <p class="font-medium">{{ res.customer }}</p>
                        <p class="text-sm text-gray-500">{{ res.vehicle }}</p>
                    </div>
                    <a href="/dashboard/reservations/{{ res.pk }}/checkin/"
                       class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                        Check-in
                    </a>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p class="text-gray-500">No returns scheduled for today.</p>
            {% endif %}
        </div>
    </div>
</div>

<!-- Upcoming Reservations -->
<div class="mt-8 bg-white rounded-lg shadow">
    <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
        <h2 class="text-lg font-semibold text-gray-900">Upcoming Reservations</h2>
        <a href="/dashboard/reservations/" class="text-blue-600 hover:underline">View All</a>
    </div>
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Customer</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Vehicle</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Dates</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Total</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for res in upcoming_reservations %}
                <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4">
                        <a href="/dashboard/reservations/{{ res.pk }}/" class="text-blue-600 hover:underline">
                            {{ res.customer }}
                        </a>
                    </td>
                    <td class="px-6 py-4">{{ res.vehicle }}</td>
                    <td class="px-6 py-4">{{ res.start_date }} - {{ res.end_date }}</td>
                    <td class="px-6 py-4">
                        <span class="px-2 py-1 rounded text-xs font-medium
                            {% if res.status == 'confirmed' %}bg-blue-100 text-blue-800
                            {% elif res.status == 'pending' %}bg-yellow-100 text-yellow-800
                            {% else %}bg-gray-100 text-gray-800{% endif %}">
                            {{ res.get_status_display }}
                        </span>
                    </td>
                    <td class="px-6 py-4">${{ res.total_amount }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="px-6 py-4 text-center text-gray-500">No upcoming reservations.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
